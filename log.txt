PS E:\RootTrading\RootTrading> python scripts/config-validator.py
=== Validation de la configuration ===
Résultats de validation de la configuration:
✅ Binance API Key
✅ Binance Secret Key
✅ Kafka Broker
✅ Redis Host
✅ Database Host
✅ Trading Symbols
✅ Trading Mode
❌ Pocket Config

Certains paramètres de configuration ne sont pas valides!

Symboles configurés: BTCUSDC, ETHUSDC
Mode de trading: live

Quantités de trading configurées:
 - BTCUSDC: 0.001
 - ETHUSDC: 0.03

Allocation des poches de capital:
 - active: 60.0%
 - buffer: 30.0%
 - safety: 10.0%

=== Validation des schémas ===
Test de création de MarketData...
✅ Validation réussie: symbol='BTCUSDC' start_time=1745932455565 close_time=1745932515565 open=20000.0 high=20100.0 low=19900.0 close=20050.0 volume=1.5 timestamp=datetime.datetime(2025, 4, 29, 15, 14, 15, 565000)

Test de création de StrategySignal...
✅ Validation réussie: strategy='rsi' symbol='BTCUSDC' side='BUY' timestamp=datetime.datetime(2025, 4, 29, 15, 14, 15, 566132) price=20000.0 confidence=None strength='strong' metadata={'rsi_value': 29.5}

Test de création de TradeOrder...
✅ Validation réussie: symbol='BTCUSDC' side='BUY' quantity=0.001 price=20000.0 client_order_id='test_order_123' strategy='rsi' stop_price=None take_profit=None trailing_delta=None leverage=1 demo=True

Test de création de TradeCycle...
✅ Validation réussie: id='cycle_123' symbol='BTCUSDC' strategy='rsi' status='waiting_buy' entry_order_id=None exit_order_id=None entry_price=None exit_price=None quantity=None target_price=None stop_price=None trailing_delta=None profit_loss=None profit_loss_percent=None created_at=datetime.datetime(2025, 4, 29, 15, 14, 15, 566132) updated_at=datetime.datetime(2025, 4, 29, 15, 14, 15, 566132) completed_at=None pocket=None demo=True

Tous les schémas sont validés avec succès!

❌ Validation échouée pour: configuration
PS E:\RootTrading\RootTrading> python scripts/db-test.py
Tentative de connexion à la base de données avec URL: postgresql://postgres:postgres@db:5432/trading
❌ Erreur de connexion à la base de données: 'utf-8' codec can't decode byte 0xf4 in position 48: invalid continuation byte
PS E:\RootTrading\RootTrading> python scripts/docker-test.py
=== Validation des fichiers Docker ===
Validation du fichier docker-compose.yml...
✅ Tous les services essentiels sont présents.
✅ Volumes définis: redis_data, kafka_data, postgres_data
⚠️ Problèmes de dépendance détectés:
  - portfolio devrait dépendre de kafka
  - trader devrait dépendre de kafka
  - coordinator devrait dépendre de kafka
  - pnl_tracker devrait dépendre de redis, kafka
  - risk_manager devrait dépendre de kafka
  - scheduler devrait dépendre de redis, kafka
  - frontend devrait dépendre de redis, kafka

Validation des Dockerfiles...
✅ Dockerfiles trouvés pour: gateway, analyzer, trader, portfolio, coordinator, dispatcher, logger, pnl_tracker, risk_manager, scheduler
✅ Tous les Dockerfiles validés contiennent les instructions essentielles.

✅ Tous les fichiers Docker semblent corrects!
PS E:\RootTrading\RootTrading> python scripts/gateway-simulator.py
Initialisation des clients Kafka et Redis...
❌ Erreur de connexion à Redis: Error 11001 connecting to redis:6379. getaddrinfo failed.
❌ Erreur lors de la simulation du Gateway: Error 11001 connecting to redis:6379. getaddrinfo failed.
PS E:\RootTrading\RootTrading> python scripts/middleware-test.py
=== Test de connexion Redis ===
Initialisation du client Redis...
❌ Erreur de connexion à Redis: Error 11001 connecting to redis:6379. getaddrinfo failed.
❌ Erreur lors du test Redis: Error 11001 connecting to redis:6379. getaddrinfo failed.

=== Test de connexion Kafka ===
Initialisation du client Kafka...
Test de création du producteur Kafka...
✅ Producteur Kafka créé avec succès!
Tentative de listage des topics Kafka...
%3|1745932545.251|FAIL|roottrading-producer-1745932542.5529237#producer-1| [thrd:kafka:9092/bootstrap]: kafka:9092/bootstrap: Failed to resolve 'kafka:9092': H¶te inconnu.  (after 2697ms in state CONNECT)
%3|1745932545.251|FAIL|rdkafka#producer-2| [thrd:kafka:9092/bootstrap]: kafka:9092/bootstrap: Failed to resolve 'kafka:9092': H¶te inconnu.  (after 2697ms in state CONNECT)
%3|1745932548.958|FAIL|rdkafka#producer-2| [thrd:kafka:9092/bootstrap]: kafka:9092/bootstrap: Failed to resolve 'kafka:9092': H¶te inconnu.  (after 2699ms in state CONNECT, 1 identical error(s) suppressed)
%3|1745932549.276|FAIL|roottrading-producer-1745932542.5529237#producer-1| [thrd:kafka:9092/bootstrap]: kafka:9092/bootstrap: Failed to resolve 'kafka:9092': H¶te inconnu.  (after 2699ms in state CONNECT, 1 identical error(s) suppressed)
❌ Erreur lors du listage des topics: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}

❌ Échec des tests de connexion pour: Redis
PS E:\RootTrading\RootTrading> python scripts/pre-start-validation.py
========================================
= VALIDATION PRÉ-DÉMARRAGE ROOTTRADING =
========================================

1. Vérification des dépendances Python...
2. Vérification de la structure des fichiers...
3. Vérification de la syntaxe Python...
4. Vérification des imports Python...
5. Vérification de la configuration...
6. Vérification de la connexion PostgreSQL...
7. Vérification de la connexion Redis...
❌ Erreur de connexion à Redis: Error 11001 connecting to redis:6379. getaddrinfo failed.
8. Vérification de la connexion Kafka...
%3|1745932573.436|FAIL|rdkafka#producer-2| [thrd:kafka:9092/bootstrap]: kafka:9092/bootstrap: Failed to resolve 'kafka:9092': H¶te inconnu.  (after 2687ms in state CONNECT)
%3|1745932573.436|FAIL|roottrading-producer-1745932570.748155#producer-1| [thrd:kafka:9092/bootstrap]: kafka:9092/bootstrap: Failed to resolve 'kafka:9092': H¶te inconnu.  (after 2687ms in state CONNECT)
%3|1745932577.144|FAIL|rdkafka#producer-2| [thrd:kafka:9092/bootstrap]: kafka:9092/bootstrap: Failed to resolve 'kafka:9092': H¶te inconnu.  (after 2694ms in state CONNECT, 1 identical error(s) suppressed)
%3|1745932577.461|FAIL|roottrading-producer-1745932570.748155#producer-1| [thrd:kafka:9092/bootstrap]: kafka:9092/bootstrap: Failed to resolve 'kafka:9092': H¶te inconnu.  (after 2699ms in state CONNECT, 1 identical error(s) suppressed)

=== RÉSUMÉ DES TESTS (49/52, 94.2%) ===

✅ Deps: 8/8 (100.0%)
✅ Files: 8/8 (100.0%)
✅ Dirs: 8/8 (100.0%)
✅ Syntax: 10/10 (100.0%)
✅ Import: 6/6 (100.0%)
✅ Config: 8/8 (100.0%)
❌ DB: 0/1 (0.0%)
❌ Redis: 0/1 (0.0%)
❌ Kafka: 1/2 (50.0%)

Tests en échec:
❌ DB:Connection: 'utf-8' codec can't decode byte 0xf4 in position 48: invalid continuation byte
❌ Redis:Connection: Error 11001 connecting to redis:6379. getaddrinfo failed.
❌ Kafka:Topics: KafkaError{code=_TRANSPORT,val=-195,str="Failed to get metadata: Local: Broker transport failure"}

⚠️ Certains tests ont échoué. Corrigez les problèmes avant de lancer Docker.
PS E:\RootTrading\RootTrading> test-unitaires.py
test-unitaires.py : Le terme «test-unitaires.py» n'est pas reconnu comme nom d'applet de commande, fonction, fichier de script ou programme exécutable. Vérifiez l'orthographe du nom, ou
si un chemin d'accès existe, vérifiez que le chemin d'accès est correct et réessayez.
Au caractère Ligne:1 : 1
+ test-unitaires.py
+ ~~~~~~~~~~~~~~~~~
    + CategoryInfo          : ObjectNotFound: (test-unitaires.py:String) [], CommandNotFoundException
    + FullyQualifiedErrorId : CommandNotFoundException

PS E:\RootTrading\RootTrading> python scripts/test-unitaires.py
....
----------------------------------------------------------------------
Ran 4 tests in 0.053s

OK